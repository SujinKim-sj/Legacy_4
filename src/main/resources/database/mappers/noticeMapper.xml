<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
   
<mapper namespace="com.spring.s1.notice.NoticeDAO">
	<select id="detail" parameterType="Long" resultType="NoticeDTO">
		SELECT * FROM NOTICE WHERE NOTICENUM = #{noticeNum}
	</select>

	<select id="total" resultType="Long" parameterType="Pager">
		SELECT COUNT(noticeNum) FROM notice
		WHERE noticeNum > 0 
				and 
				
				<choose>
					<when test="kind=='col1'">
						NOTICETITLE
					</when>
					<when test="kind=='col2'">
						NOTICECONTENTS
					</when>
					<otherwise>
						NOTICEWRITER
					</otherwise>
				</choose>
				
				LIKE '%' || #{search} || '%'
	</select>

	<select id="list" parameterType="Pager" resultType="NoticeDTO">
		SELECT * FROM
			(SELECT rowNum R, B.* FROM
				(SELECT * FROM notice 
				WHERE noticeNum > 0 
				and 
				
				<choose>
					<when test="kind=='col1'">
						NOTICETITLE
					</when>
					<when test="kind=='col2'">
						NOTICECONTENTS
					</when>
					<otherwise>
						NOTICEWRITER
					</otherwise>
				</choose>
				
				LIKE '%' || #{search} || '%'
				ORDER BY noticeNum DESC) B)
		WHERE R between #{startRow} and #{lastRow}
	</select>
	
	<insert id="add" parameterType="NoticeDTO">
		INSERT INTO NOTICE
		VALUES(NOTICE_SEQ.NEXTVAL, #{noticeTitle}, #{noticeContents}, #{noticeWriter}, SYSDATE, 0)
	</insert>
	
	<delete id="delete" parameterType="NoticeDTO">
		DELETE NOTICE WHERE NOTICENUM = #{noticeNum}
	</delete>
</mapper>